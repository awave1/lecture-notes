# Entropy, Product Ciphers, Block Ciphers

**Outline**:
* Entropy
* Product Ciphers
* Error Propagation
* Block Ciphers
* The Data Encryption Standard
    * Triple DES
* History Post-DES


> Entropy: The average amount of uncertainty. 0 entropy == certainty

## Entropy
```
todo: finish
```
Let $x$ be a random variable taking on the values $x_1, x_2, ..., x_n$ with a probability distribution:

$$
p(x_1), p(x_2), ...,p(x_n) \space where \space \sum_{i = 1}^{n} p(x_i) = 1
$$

The entropy of $x$ is defined by the weighted average:

$$
H(x) = \sum_{i = 1 \\ p(x_i) \neq 0} p(x_i)
$$

## Product Ciphers


## Error Propagation
**Error Propagation**: The degree to which a change in the input leads to changes in the output.

**Avalanche Effect**: Changing one input 

Good error propagation is a desirable property of a cryptosystem (a user can easily tell if a message has been modified). Not necessarily good for decryption though.

## Block Ciphers
All modern ciphers are block ciphers, but not necessarily used as such.

**Block Cipher** - encrypts plaintexts blocks of some fixed length to ciphertext blocks of some fixed (possibly different) length.

Usually a message $`m`$ will be larger than the plaintext block length, and must hence be divided into a series of sequential message blocks $`m_1, m_2, m_3, ..., m_n`$..

### Examples of Block Ciphers
The shift cipher is a block cipher where the blocks consists of one character (i.e. 8 bits on 32bit architecture, 16 bits on 64bit architecture).

Two main block ciphers in use today:
* Data Encryption Standard (DES)
    * Obsolete
    * Still used in legacy code as triple encipherment (3DES)
* Advanced Encryption Standard (AES)

### DES
DES was described in FISP (Federal Information Process Register) 46, 46-2, 46-3. Developed by IBM around 1972 in secred (based on Lucifer), with input from NSA. It's a block cipher that encrypts 64bit plaintext blocks using 64bit keys. (Note: 8 of the key bits are parity bits, resulting in 56 actual bits of the key).

$$
M = C = \{0, 1\}^{64} \space and \space K = \{0, 1\}^{56}
$$

Algorithm consists of 16 rounds of permutations and substitutions

$$
DES_{k}(m) = IP^{-1}(S_{16}(S_{15}(...(S_2(S_1(IP(m)))))))
$$

#### Multiple DES Encryption
Campbell and Wiener (1992) proved that DES is not closed, so multiple DES encryptions/decryptions could potentially provide additional secutrity.

Size of the group generated by all the keys (i.e. the number of distinct encryptions obtained by applying repeated DES enryptions) has been shown to have size at least $10^{2499} = 2^{8302}$.

Double encryption is no more secure than single encryption, but twice as slow.

#### 3DES
Uses three successive DES operations: $C = DES_{k_1}(DES_{k_2}^{-1}(DES_{k_3}(m)))$.

**Advantages**:
* Same as single key, if $k_1 = k_2$ or $k_2 = k_3$
* Exhaustive search has complexity $2^{112}$ via the meet-in-the-middle attack, but with a 168bit key and a factor of 3 in speed
* Can use $k_1 = k_3$ with no loss of secrecy
* No other known practical attacks

Main disadvantage is that 3DES is 3 times slowr than DES, while only doubling the key size.

#### Skipjack and Clipper Clip
After DES became obsolete, NSA wanted to control the cipher standard selection process:
* Proposed the Skipjack Algorithm on the Clipper Clip
* Standardized by NIST as Escrowed Encryption Standard (EES) in feb. 1994

The details of Clipper and Skipjack were intially classified and kept secret. The cipher was never caught in the public sector.

### AES
**AES** is replacement for **DES**. Requirements for AES:
* Possible key sizes of 128, 192, and 256 bits
* Plaintexts and ciphertexts of 128 bits
* Should be cross platform
* Fast
* Secure
* World wide royalty free avialiability

#### Rijndael
Was standarized as AES in 2001. The **Rijndael** algorithm uses two different types of arithmetic
* Arithmetic on bytes (8bit vectors, elements of finite field $GF(2^8)$ of 256 elements)
* 4byte vectors (actually polynimial operations over $GF(2^8)$)

The algorithm uses addition, multiplication, and inversion on bytes as well as addition and multiplication of 4byte vectors. Rijndael is a product cipher, but not a Feistel cipher like DES. Instead, it has three layers per round:
1. A linear mixing layer (`ShiftRows`, transpositions, and `MixColumns`, a linear transformations; for diffusion over multiple rounds)
2. A non-linear layer (`SubBytes`, substitution done with `S`-box)
3. A key addition layer (`AddRoundKey`, `xor` with key)
