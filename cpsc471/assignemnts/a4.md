### Question 1

1. Find names and cities of publishers distributing red books to at least one school not located in Calgary?

```sql
SELECT p.name, p.city FROM School AS s
JOIN Distribute AS d ON d.sname = s.name and s.city != "Calgary"
JOIN Books as b on b.ISBN = d.ISBN and b.color = "Red"
JOIN Publisher as p on p.name = d.pname;
```

2. Find directors of the schools located in Paris and receiving books from publishers located in London?

```sql
SELECT s.director FROM School AS s
JOIN Distribute ON sname = s.name and s.city = "Paris"
JOIN Publisher as p on pname = p.name and p.city = "London";
```

3. Find names of schools receiving books from publishers located in Roma and distributing books to at least one school located in Toronto?

```sql
SELECT s.name FROM School AS s
JOIN Distribute AS d ON d.sname = s.name
JOIN Publisher AS p ON p.name = d.pname AND p.city = "Rome"
WHERE s.city = "Toronto";
```

4. Find the name and total quantity of each book distributed only to all the schools in Calgary?

```sql
SELECT b.title, COUNT(*) FROM School AS s
JOIN Distribute as d ON d.sname = s.name
JOIN Books as b ON b.ISBN = d.ISBN
WHERE s.city = "Calgary"
GROUP BY b.title;
```

5. Find the name and total quantity of each book distributed to all the schools in the publisherâ€™s city?

```sql
SELECT b.title, COUNT(*) FROM School AS s
JOIN Distribute as d ON d.sname = s.name
JOIN Books as b ON b.ISBN = d.ISBN
JOIN Publisher as p
WHERE s.city = p.city;
```

### Question 2

1. Find street number of the longest street in each city in Canada?

```sql
SELECT s.stno, MAX(s.length) FROM Street as s
JOIN City as c ON s.city-name = c.city-name AND c.country = "Canada"
GROUP BY c.city-name;
```

2. Find names of persons who own at least one house in each city in Canada?

```sql
SELECT h.owner-name FROM City AS c
JOIN Street as s ON s.city-name = c.city-name
JOIN House as h ON h.stno = s.stno
WHERE c.country-name = "Canada"
GROUP BY h.owner-name;

```

3. Find names of persons who own more than one house outside USA and at least one inside the
USA?

```sql
SELECT h.owner-name, COUNT(*) house_count FROM City AS c
JOIN Street as s ON s.city-name = c.city-name and c.country-name = "US"
JOIN House as h ON h.stno = s.stno
GROUP BY h.owner-name
HAVING house_count > 1
  UNION
SELECT h.owner-name, COUNT(*) house_count FROM City AS c
JOIN Street as s ON s.city = c.city and c.country-name != "US"
JOIN House as h ON h.stno = s.stno
GROUP BY h.owner-name
HAVING house_count >= 1;
```

4. Find names of countries that have border with Germany?

```sql
SELECT c.name FROM Country as c
JOIN Border b ON b.country-name1 = "Germany" AND c.name = b.country-name2;
```

5. Find names of persons who own at least one house in each of the countries that border Spain? 

```sql
SELECT h.owner-name, COUNT(*) house_count FROM House AS h
JOIN Street s ON s.stno = h.stno
JOIN City c ON c.city = s.city
JOIN Border AS b ON b.country1 = "Spain" and c.country = b.country2;
GROUP BY h.owner-name
HAVING house_count >= 1;
```
